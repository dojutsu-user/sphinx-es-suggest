"use strict";var MAX_SUGGESTIONS=50,MAX_SECTION_RESULTS=3,MAX_SUBSTRING_LIMIT=100,ANIMATION_TIME=200,FETCH_RESULTS_DELAY=250,CLEAR_RESULTS_DELAY=300,COUNT=0,debounce=function(r,n){function e(){var e=this,t=arguments;clearTimeout(a),a=setTimeout(function(){return r.apply(e,t)},n)}var a;return e.cancel=function(){clearTimeout(a),a=null},e},convertObjToUrlParams=function(t){for(var e=Object.keys(t).map(function(e){if(_is_string(e))return e+"="+encodeURI(t[e])}),r=[],n=0;n<e.length;++n)_is_string(e[n])&&r.push(e[n]);return 1===r.length?r[0]:r.join("&")},updateUrl=function(){var e=window.location.origin,t=window.location.pathname,r=$.getQueryParameters(),n=window.location.hash,a=getSearchTerm();0<a.length?r.rtd_search=a:delete r.rtd_search;n=t+"?"+(convertObjToUrlParams(r)+n);"http"===e.substring(0,4)&&(n=e+n),window.history.pushState({},null,n)},updateSearchBar=function(){getInputField().value=getSearchTerm()},isModalVisible=function(){var e=document.querySelector(".search__outer__wrapper");return null!==e&&null!==e.style&&null!==e.style.display&&"block"===e.style.display},createDomNode=function(e,t){var r,n=document.createElement(e);for(r in t)n.setAttribute(r,t[r]);return n},_is_string=function(e){return"string"==typeof e&&0<e.length},_is_array=function(e){return!!(Array.isArray(e)&&0<e.length)},get_section_html=function(e,t){var r=e.title,n=e.highlights;n.title.length&&(r=n.title[0]);var a=[e.content.substring(0,MAX_SUBSTRING_LIMIT)+" ..."];if(n.content.length)for(var o=n.content,a=[],s=0;s<o.length&&s<MAX_SECTION_RESULTS;++s)a.push("... "+o[s]+" ...");t="".concat(t,"#").concat(e.id),e="hit__"+COUNT;return $u.template('<a href="<%= section_link %>">             <div class="outer_div_page_results" id="<%= section_id %>">                 <span class="search__result__subheading">                     <%= section_subheading %>                 </span>                 <% for (var i = 0; i < section_content.length; ++i) { %>                     <p class="search__result__content">                         <%= section_content[i] %>                     </p>                 <% } %>            </div>         </a>         <br class="br-for-hits">',{section_link:t,section_id:e,section_subheading:r,section_content:a})},get_domain_html=function(e,t){var r="".concat(t,"#").concat(e.id),n=e.role,a=e.name,t=e.content.substr(0,MAX_SUBSTRING_LIMIT)+" ...",e=e.highlights;e.name.length&&(a=e.name[0]),e.content.length&&(t=e.content[0]);e="hit__"+COUNT,n="["+n+"]";return $u.template('<a href="<%= domain_link %>">             <div class="outer_div_page_results" id="<%= domain_id %>">                 <span class="search__result__subheading">                     <%= domain_subheading %>                     <div class="search__domain_role_name">                         <%= domain_role_name %>                     </div>                 </span>                 <p class="search__result__content"><%= domain_content %></p>             </div>         </a>         <br class="br-for-hits">',{domain_link:r,domain_id:e,domain_content:t,domain_subheading:a,domain_role_name:n})},generateSingleResult=function(e,t){var r=createDomNode("div"),n=e.path,a=e.title,o=e.highlights;o.title.length&&(a=o.title[0]),t!==e.project&&(a+=" "+$u.template('<small class="rtd_ui_search_subtitle">                     (from project <%= project %>)                 </small>',{project:e.project})),a+="<br>",r.innerHTML+=$u.template('<a href="<%= page_link %>">             <h2 class="search__result__title">                 <%= page_title %>             </h2>         </a>',{page_link:n,page_title:a});for(var s=0;s<e.blocks.length;++s){var i=e.blocks[s];COUNT+=1;var c="";"section"===i.type?c=get_section_html(i,n):"domain"===i.type&&(c=get_domain_html(i,n)),r.innerHTML+=c}return r},generateSuggestionsList=function(e,t){for(var r=createDomNode("div",{class:"search__result__box"}),n=Math.min(MAX_SUGGESTIONS,e.results.length),a=0;a<n;++a){var o=createDomNode("div",{class:"search__result__single"}),s=generateSingleResult(e.results[a],t);o.appendChild(s),r.appendChild(o)}var i=createDomNode("div",{class:"search__result__single"});return COUNT+=1,i.appendChild(getDefaultSearchLink(COUNT)),r.appendChild(i),r},removeAllActive=function(){for(var t=document.querySelectorAll(".outer_div_page_results"),e=Object.keys(t).map(function(e){return t[e]}),r=1;r<=e.length;++r)e[r-1].classList.remove("active")},addActive=function(e){e=document.querySelector("#hit__"+e);null!==e&&(e.classList.add("active"),e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))},getInputField=function(){var t;try{if(null==(t=document.querySelector("[role='search'] input")))throw"'[role='search'] input' not found"}catch(e){t=document.querySelector("input[name='q']")}return t},getSearchTerm=function(){var e=document.querySelector(".search__outer__input");return null!==e&&e.value||""},removeResults=function(){for(var e=document.querySelectorAll(".search__result__box"),t=0;t<e.length;++t)e[t].parentElement.removeChild(e[t])},getErrorDiv=function(e){var t=createDomNode("div",{class:"search__result__box search__error__box"});return t.innerHTML=e,t},getDefaultSearchLink=function(e){var t=createDomNode("a",{href:"#"}),e=$u.template('<div class="outer_div_page_results" id="<%= id %>">             <p>Show all results.</p>         </div>',{id:"hit__"+e});return t.innerHTML=e,t.onclick=function(){return defaultSearch(),!1},t},fetchAndGenerateResults=function(e,n){var a=document.querySelector(".search__outer");removeResults();var t=createDomNode("div",{class:"search__result__box"});return t.innerHTML="<strong>Searching ....</strong>",a.appendChild(t),debounce(function(){updateUrl(),updateSearchBar(),$.ajax({url:e,crossDomain:!0,xhrFields:{withCredentials:!0},complete:function(e,t){var r;"success"!==t&&void 0===e.responseJSON||(0<e.responseJSON.results.length?(r=generateSuggestionsList(e.responseJSON,n),removeResults(),a.appendChild(r),a.addEventListener("mouseenter",function(e){removeAllActive()})):(r=getErrorDiv("No results found."),COUNT=1,r.appendChild(getDefaultSearchLink(1)),removeResults(),a.appendChild(r)))},error:function(e,t,r){var n=getErrorDiv("There was an error. Please try again.");COUNT=1,n.appendChild(getDefaultSearchLink(1)),removeResults(),a.appendChild(n)}})},FETCH_RESULTS_DELAY)},generateAndReturnInitialHtml=function(){return'<div class="search__outer__wrapper search__backdrop">             <div class="search__outer">                 <div class="search__cross" title="Close">                     \x3c!--?xml version="1.0" encoding="UTF-8"?--\x3e                     <svg class="search__cross__img" width="15px" height="15px" enable-background="new 0 0 612 612" version="1.1" viewBox="0 0 612 612" xml:space="preserve" xmlns="http://www.w3.org/2000/svg">                         <polygon points="612 36.004 576.52 0.603 306 270.61 35.478 0.603 0 36.004 270.52 306.01 0 576 35.478 611.4 306 341.41 576.52 611.4 612 576 341.46 306.01"></polygon>                     </svg>                 </div>                 <input class="search__outer__input" placeholder="Search ...">                 <span class="bar"></span>             </div>             <div class="rtd__search__credits">                 <small>                     Search by <a href="https://readthedocs.org/">Read the Docs</a> & <a href="https://readthedocs-sphinx-search.readthedocs.io/">readthedocs-sphinx-search</a>                 <small>             <div>         </div>'},showSearchModal=function(t){removeResults();var r=getInputField();r.blur(),$(".search__outer__wrapper").fadeIn(ANIMATION_TIME,function(){var e=document.querySelector(".search__outer__input");null!==e&&(void 0!==t&&_is_string(t)?(e.value=t,r.value=t):e.value=r.value,e.focus())})},removeSearchModal=function(){removeResults(),updateSearchBar();var e=document.querySelector(".search__outer__input");null!==e&&(e.value="",e.blur()),updateUrl(),$(".search__outer__wrapper").fadeOut(ANIMATION_TIME)},defaultSearch=function(){var e=getInputField(),t=e.parentElement;e.value=getSearchTerm(),t.submit()};window.addEventListener("DOMContentLoaded",function(e){var n,a,o,t,r,s,i,c;window.hasOwnProperty("READTHEDOCS_DATA")?(n=READTHEDOCS_DATA.project,a=READTHEDOCS_DATA.version,o=READTHEDOCS_DATA.language||"en",c=generateAndReturnInitialHtml(),document.body.innerHTML+=c,t=document.querySelector(".search__outer__wrapper"),r=document.querySelector(".search__outer__input"),c=document.querySelector(".search__cross"),s=0,i=null,getInputField().addEventListener("focus",function(e){showSearchModal()}),r.addEventListener("input",function(e){var t=getSearchTerm();COUNT=0;var r="/_/api/v2/search/?"+convertObjToUrlParams({q:t,project:n,version:a,language:o});0<t.length?(null!==i&&i.cancel(),(i=fetchAndGenerateResults(r,n))()):(debounce(function(){removeResults(),updateUrl()},CLEAR_RESULTS_DELAY)(),updateUrl())}),r.addEventListener("keydown",function(e){40===e.keyCode&&(e.preventDefault(),COUNT<(s+=1)&&(s=1),removeAllActive(),addActive(s)),38===e.keyCode&&(e.preventDefault(),--s<1&&(s=COUNT),removeAllActive(),addActive(s)),13===e.keyCode&&(e.preventDefault(),null!==(e=document.querySelector(".outer_div_page_results.active"))&&e.parentElement.click())}),t.addEventListener("click",function(e){e.target.parentNode===document.body&&removeSearchModal()}),c.addEventListener("click",function(e){removeSearchModal()}),document.addEventListener("keydown",function(e){27===e.keyCode&&removeSearchModal()}),document.addEventListener("keydown",function(e){191!==e.keyCode||isModalVisible()||(e.preventDefault(),showSearchModal())}),c=$.getQueryParameters(),_is_array(c.rtd_search)&&(c=decodeURIComponent(c.rtd_search),showSearchModal(c),r.value=c,(c=document.createEvent("Event")).initEvent("input",!0,!0),r.dispatchEvent(c))):console.log("[INFO] Docs are not being served on Read the Docs, readthedocs-sphinx-search will not work.")});