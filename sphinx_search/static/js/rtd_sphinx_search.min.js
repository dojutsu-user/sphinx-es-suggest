"use strict";var MAX_SUGGESTIONS=50,MAX_SECTION_RESULTS=3,MAX_SUBSTRING_LIMIT=100,ANIMATION_TIME=200,FETCH_RESULTS_DELAY=250,CLEAR_RESULTS_DELAY=300,RTD_SEARCH_PARAMETER="rtd_search",debounce=function(r,n){function e(){var e=this,t=arguments;clearTimeout(a),a=setTimeout(function(){return r.apply(e,t)},n)}var a;return e.cancel=function(){clearTimeout(a),a=null},e},render_template=function(e,t){var r=$u.template(e,t);return r="function"==typeof r?$u.template(e)(t):r},updateUrl=function(){var e=new URL(window.location.href),t=getSearchTerm();0<t.length?e.searchParams.set(RTD_SEARCH_PARAMETER,t):e.searchParams.delete(RTD_SEARCH_PARAMETER),window.history.pushState({},null,e.toString())},updateSearchBar=function(){getInputField().value=getSearchTerm()},isModalVisible=function(){var e=document.querySelector(".search__outer__wrapper");return null!==e&&null!==e.style&&null!==e.style.display&&"block"===e.style.display},createDomNode=function(e,t){var r,n=document.createElement(e);for(r in t)n.setAttribute(r,t[r]);return n},_is_string=function(e){return"string"==typeof e&&0<e.length},get_section_html=function(e,t,r){var n=e.title,a=e.highlights;a.title.length&&(n=a.title[0]);var o=[e.content.substring(0,MAX_SUBSTRING_LIMIT)+" ..."];if(a.content.length)for(var s=a.content,o=[],c=0;c<s.length&&c<MAX_SECTION_RESULTS;++c)o.push("... "+s[c]+" ...");e="".concat(t,"#").concat(e.id);return render_template('<a href="<%= section_link %>">             <div class="outer_div_page_results" id="<%= section_id %>">                 <span class="search__result__subheading">                     <%= section_subheading %>                 </span>                 <% for (var i = 0; i < section_content.length; ++i) { %>                     <p class="search__result__content">                         <%= section_content[i] %>                     </p>                 <% } %>            </div>         </a>         <br class="br-for-hits">',{section_link:e,section_id:"hit__"+r,section_subheading:n,section_content:o})},get_domain_html=function(e,t,r){var n="".concat(t,"#").concat(e.id),a=e.role,o=e.name,t=e.content.substr(0,MAX_SUBSTRING_LIMIT)+" ...",e=e.highlights;return e.name.length&&(o=e.name[0]),e.content.length&&(t=e.content[0]),render_template('<a href="<%= domain_link %>">             <div class="outer_div_page_results" id="<%= domain_id %>">                 <span class="search__result__subheading">                     <%= domain_subheading %>                     <div class="search__domain_role_name">                         <%= domain_role_name %>                     </div>                 </span>                 <p class="search__result__content"><%= domain_content %></p>             </div>         </a>         <br class="br-for-hits">',{domain_link:n,domain_id:"hit__"+r,domain_content:t,domain_subheading:o,domain_role_name:a="["+a+"]"})},generateSingleResult=function(e,t,r){var n=createDomNode("div"),a=e.path,o=e.title,s=e.highlights;s.title.length&&(o=s.title[0]),t!==e.project&&(o+=" "+render_template('<small class="rtd_ui_search_subtitle">                     (from project <%= project %>)                 </small>',{project:e.project})),o+="<br>",n.innerHTML+=render_template('<a href="<%= page_link %>">             <h2 class="search__result__title">                 <%= page_title %>             </h2>         </a>',{page_link:a,page_title:o});for(var c=0;c<e.blocks.length;++c){var l=e.blocks[c],i="";r+=1,"section"===l.type?i=get_section_html(l,a,r):"domain"===l.type&&(i=get_domain_html(l,a,r)),n.innerHTML+=i}return n},generateSuggestionsList=function(e,t){for(var r=createDomNode("div",{class:"search__result__box"}),n=Math.min(MAX_SUGGESTIONS,e.results.length),a=0,o=0;o<n;++o){var s=createDomNode("div",{class:"search__result__single"}),c=generateSingleResult(e.results[o],t,a);s.appendChild(c),r.appendChild(s),a+=e.results[o].blocks.length}return r},removeAllActive=function(){for(var t=document.querySelectorAll(".outer_div_page_results.active"),e=Object.keys(t).map(function(e){return t[e]}),r=1;r<=e.length;++r)e[r-1].classList.remove("active")},addActive=function(e){e=document.querySelector("#hit__"+e);null!==e&&(e.classList.add("active"),e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))},selectNextResult=function(e){var t=document.querySelectorAll(".outer_div_page_results"),r=document.querySelector(".outer_div_page_results.active"),n=1,a=1;0<t.length&&(null===(t=t[t.length-1]).id||null!==(t=t.id.match(/\d+/))&&(a=Number(t[0]))),null===r||null===r.id||null!==(r=r.id.match(/\d+/))&&(n=Number(r[0]),n+=e?1:-1),n<=0?n=a:a<n&&(n=1),removeAllActive(),addActive(n)},getInputField=function(){var t;try{if(null==(t=document.querySelector("[role='search'] input")))throw"'[role='search'] input' not found"}catch(e){t=document.querySelector("input[name='q']")}return t},getSearchTerm=function(){var e=document.querySelector(".search__outer__input");return null!==e&&e.value||""},removeResults=function(){for(var e=document.querySelectorAll(".search__result__box"),t=0;t<e.length;++t)e[t].parentElement.removeChild(e[t])},getErrorDiv=function(e){var t=createDomNode("div",{class:"search__result__box search__error__box"});return t.innerHTML=e,t},fetchAndGenerateResults=function(t,r,n){var a=document.querySelector(".search__outer");removeResults();var e=createDomNode("div",{class:"search__result__box"});e.innerHTML="<strong>Searching ....</strong>",a.appendChild(e);return debounce(function(){updateUrl(),updateSearchBar();var e=t+"?"+new URLSearchParams(r).toString();fetch(e,{method:"GET"}).then(function(e){if(!e.ok)throw new Error;return e.json()}).then(function(e){var t;0<e.results.length?(t=generateSuggestionsList(e,n),removeResults(),a.appendChild(t),a.addEventListener("mouseenter",function(e){removeAllActive()})):(removeResults(),t=getErrorDiv("No results found"),a.appendChild(t))}).catch(function(e){removeResults();var t=getErrorDiv("There was an error. Please try again.");a.appendChild(t)})},FETCH_RESULTS_DELAY)},generateAndReturnInitialHtml=function(){var e=createDomNode("div",{class:"search__outer__wrapper search__backdrop"});return e.innerHTML='<div class="search__outer">             <div class="search__cross" title="Close">                 \x3c!--?xml version="1.0" encoding="UTF-8"?--\x3e                 <svg class="search__cross__img" width="15px" height="15px" enable-background="new 0 0 612 612" version="1.1" viewBox="0 0 612 612" xml:space="preserve" xmlns="http://www.w3.org/2000/svg">                     <polygon points="612 36.004 576.52 0.603 306 270.61 35.478 0.603 0 36.004 270.52 306.01 0 576 35.478 611.4 306 341.41 576.52 611.4 612 576 341.46 306.01"></polygon>                 </svg>             </div>             <input class="search__outer__input" placeholder="Search ...">             <span class="bar"></span>         </div>         <div class="rtd__search__credits">             Search by <a href="https://readthedocs.org/">Read the Docs</a> & <a href="https://readthedocs-sphinx-search.readthedocs.io/en/latest/">readthedocs-sphinx-search</a>         </div>',e},showSearchModal=function(r){removeResults(),$(".search__outer__wrapper").fadeIn(ANIMATION_TIME,function(){var e=getInputField();e.blur();var t=document.querySelector(".search__outer__input");null!==t&&(void 0!==r&&_is_string(r)?(t.value=r,e.value=r):t.value=e.value,t.focus())})},removeSearchModal=function(){removeResults(),updateSearchBar();var e=document.querySelector(".search__outer__input");null!==e&&(e.value="",e.blur()),updateUrl(),$(".search__outer__wrapper").fadeOut(ANIMATION_TIME)};window.addEventListener("DOMContentLoaded",function(){var r,n,a,e,t,o,s,c;window.hasOwnProperty("READTHEDOCS_DATA")?(r=READTHEDOCS_DATA.project,n=READTHEDOCS_DATA.version,a=READTHEDOCS_DATA.proxied_api_host||"/_",c=generateAndReturnInitialHtml(),document.body.appendChild(c),e=document.querySelector(".search__outer__wrapper"),t=document.querySelector(".search__outer__input"),c=document.querySelector(".search__cross"),o=null,(s=getInputField()).addEventListener("focus",function(e){showSearchModal()}),t.addEventListener("input",function(e){var t=getSearchTerm();0<t.length?(null!==o&&o.cancel(),(o=fetchAndGenerateResults(a+"/api/v2/search/",{q:t,project:r,version:n},r))()):(debounce(function(){removeResults(),updateUrl()},CLEAR_RESULTS_DELAY)(),updateUrl())}),t.addEventListener("keydown",function(e){var t;40===e.keyCode&&(e.preventDefault(),selectNextResult(!0)),38===e.keyCode&&(e.preventDefault(),selectNextResult(!1)),13===e.keyCode&&(e.preventDefault(),null!==(e=document.querySelector(".outer_div_page_results.active"))?(t=e.parentElement.href,window.location.href=t):(t=getInputField().parentElement,s.value=getSearchTerm(),t.submit()))}),e.addEventListener("click",function(e){e.target.parentNode===document.body&&removeSearchModal()}),c.addEventListener("click",function(e){removeSearchModal()}),document.addEventListener("keydown",function(e){27===e.keyCode&&removeSearchModal()}),document.addEventListener("keydown",function(e){191!==e.keyCode||isModalVisible()||(e.preventDefault(),showSearchModal())}),null!==(c=new URLSearchParams(document.location.search).get(RTD_SEARCH_PARAMETER))&&(showSearchModal(c),t.value=c,(c=document.createEvent("Event")).initEvent("input",!0,!0),t.dispatchEvent(c))):console.log("[INFO] Docs are not being served on Read the Docs, readthedocs-sphinx-search will not work.")});