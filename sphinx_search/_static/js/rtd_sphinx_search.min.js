"use strict";var MAX_SUGGESTIONS=10,TOTAL_RESULTS=0,SEARCH_QUERY="",debounce=function(t,n){function e(){var e=this,r=arguments;clearTimeout(o),o=setTimeout(function(){return t.apply(e,r)},n)}var o;return e.cancel=function(){clearTimeout(o),o=null},e},convertObjToUrlParams=function(r){return Object.keys(r).map(function(e){return e+"="+r[e]}).join("&")},createDomNode=function(e,r){var t=document.createElement(e);for(var n in r)t.setAttribute(n,r[n]);return t},generateSuggestionsList=function(e,r){for(var t=createDomNode("div",{class:"search__result__box"}),n=0;n<TOTAL_RESULTS;++n){var o=createDomNode("div",{class:"search__result__single",id:"hit__"+(n+1)}),a=createDomNode("a",{href:e.results[n].link+DOCUMENTATION_OPTIONS.FILE_SUFFIX}),c=createDomNode("div",{class:"content"}),s=createDomNode("h2",{class:"search__result__title"});void 0!==e.results[n].highlight.title?s.innerHTML=e.results[n].highlight.title[0]:s.innerHTML=e.results[n].title,c.appendChild(s),c.appendChild(createDomNode("br"));var l=createDomNode("small",{class:"search__result__path"});l.innerHTML=e.results[n].path,e.results[n].project!==r&&(l.innerHTML=e.results[n].path+" (from <strong>"+e.results[n].project+"</strong>)"),c.appendChild(l);var i=createDomNode("p",{class:"search__result__content"});void 0!==e.results[n].highlight.content?i.innerHTML="... "+e.results[n].highlight.content+" ...":i.innerHTML="",c.appendChild(i),a.appendChild(c),o.appendChild(a),t.appendChild(o)}return t},removeAllActive=function(){for(var r=document.querySelectorAll(".search__result__single"),e=Object.keys(r).map(function(e){return r[e]}),t=1;t<=e.length;++t)e[t-1].classList.remove("active")},addActive=function(e){var r=document.querySelector("#hit__"+e);null!==r&&(r.classList.add("active"),r.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))},getInputField=function(){return document.querySelector("div[role='search'] input")},removeResults=function(){for(var e=document.querySelectorAll(".search__result__box"),r=0;r<e.length;++r)e[r].parentElement.removeChild(e[r])},getErrorDiv=function(e){var r=createDomNode("div",{class:"search__result__box",style:"color: black; min-width: 300px"});return r.innerHTML=e,r},fetchAndGenerateResults=function(e,o){var a=document.querySelector(".search__outer");removeResults();var r=createDomNode("div",{class:"search__result__box"});r.innerHTML="Searching ....",a.appendChild(r);var t=function(){$.ajax({url:e,crossDomain:!0,xhrFields:{withCredentials:!0},complete:function(e,r){if("success"===r||void 0!==e.responseJSON)if(0<e.responseJSON.results.length){TOTAL_RESULTS=MAX_SUGGESTIONS<=e.responseJSON.results.length?MAX_SUGGESTIONS:e.responseJSON.results.length;var t=generateSuggestionsList(e.responseJSON,o);removeResults(),a.appendChild(t),a.addEventListener("mouseenter",function(e){removeAllActive()})}else{removeResults();var n=getErrorDiv("No Results Found");a.appendChild(n)}},error:function(e,r,t){removeResults();var n=getErrorDiv("Error Occurred. Please try again.");a.appendChild(n)}})};return t=debounce(t,500)},generateAndReturnInitialHtml=function(){var e=createDomNode("div",{class:"search__outer__wrapper search__backdrop"}),r=createDomNode("div",{class:"search__outer"}),t=createDomNode("div",{class:"search__cross",title:"Close"});t.innerHTML="<?xml version='1.0' encoding='UTF-8'?><svg class='search__cross__img' width='15px' height='15px' enable-background='new 0 0 612 612' version='1.1' viewBox='0 0 612 612' xml:space='preserve' xmlns='http://www.w3.org/2000/svg'><polygon points='612 36.004 576.52 0.603 306 270.61 35.478 0.603 0 36.004 270.52 306.01 0 576 35.478 611.4 306 341.41 576.52 611.4 612 576 341.46 306.01'/></svg>",r.appendChild(t);var n=createDomNode("input",{class:"search__outer__input",placeholder:"Search ..."}),o=createDomNode("button",{class:"search__link__button",title:"Copy link to search"});o.innerHTML='<?xml version="1.0" encoding="UTF-8"?><svg width="15px" height="15px" enable-background="new 0 0 465.951 465.951" version="1.1" viewBox="0 0 465.951 465.951" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"><path d="m441.96 284.36l-59.389-59.383c-15.984-15.985-35.396-23.982-58.238-23.982-23.223 0-43.013 8.375-59.385 25.125l-25.125-25.125c16.751-16.368 25.125-36.256 25.125-59.671 0-22.841-7.898-42.157-23.698-57.958l-58.815-59.097c-15.798-16.178-35.212-24.27-58.242-24.27-22.841 0-42.16 7.902-57.958 23.7l-41.97 41.683c-16.179 15.802-24.267 35.118-24.267 57.957 0 22.841 7.996 42.258 23.982 58.245l59.385 59.383c15.99 15.988 35.404 23.982 58.245 23.982 23.219 0 43.015-8.374 59.383-25.126l25.125 25.126c-16.75 16.371-25.125 36.258-25.125 59.672 0 22.843 7.898 42.154 23.697 57.958l58.82 59.094c15.801 16.177 35.208 24.27 58.238 24.27 22.844 0 42.154-7.897 57.958-23.698l41.973-41.682c16.177-15.804 24.271-35.118 24.271-57.958-5e-3 -22.838-7.999-42.25-23.99-58.245zm-240.96-122.19c-0.571-0.571-2.334-2.378-5.28-5.424-2.948-3.046-4.995-5.092-6.136-6.14-1.143-1.047-2.952-2.474-5.426-4.286-2.478-1.809-4.902-3.044-7.28-3.711-2.38-0.666-4.998-0.998-7.854-0.998-7.611 0-14.084 2.666-19.414 7.993s-7.992 11.799-7.992 19.414c0 2.853 0.332 5.471 0.998 7.851 0.666 2.382 1.903 4.808 3.711 7.281 1.809 2.474 3.237 4.283 4.283 5.426 1.044 1.141 3.09 3.188 6.136 6.139 3.046 2.95 4.853 4.709 5.424 5.281-5.711 5.898-12.563 8.848-20.555 8.848-7.804 0-14.277-2.568-19.414-7.705l-59.39-59.386c-5.327-5.33-7.992-11.802-7.992-19.417 0-7.421 2.662-13.796 7.992-19.126l41.971-41.687c5.523-5.14 11.991-7.705 19.417-7.705 7.611 0 14.083 2.663 19.414 7.993l58.813 59.097c5.33 5.33 7.992 11.801 7.992 19.414 1e-3 7.991-3.139 14.94-9.418 20.848zm202.15 199.55l-41.973 41.686c-5.332 4.945-11.8 7.423-19.418 7.423-7.809 0-14.27-2.566-19.41-7.707l-58.813-59.101c-5.331-5.332-7.99-11.8-7.99-19.41 0-7.994 3.138-14.941 9.421-20.841 0.575 0.567 2.334 2.381 5.284 5.42 2.95 3.046 4.996 5.093 6.14 6.14 1.143 1.051 2.949 2.478 5.42 4.288 2.478 1.811 4.9 3.049 7.282 3.713 2.382 0.667 4.997 0.999 7.851 0.999 7.618 0 14.086-2.665 19.418-7.994 5.324-5.328 7.994-11.8 7.994-19.41 0-2.854-0.339-5.472-1-7.851-0.67-2.382-1.902-4.809-3.72-7.282-1.811-2.471-3.23-4.284-4.281-5.428-1.047-1.136-3.094-3.183-6.139-6.14-3.046-2.949-4.853-4.709-5.428-5.276 5.715-6.092 12.566-9.138 20.554-9.138 7.617 0 14.085 2.663 19.41 7.994l59.388 59.382c5.332 5.332 7.995 11.807 7.995 19.417 0 7.416-2.663 13.799-7.985 19.116z"/></svg>';var a=createDomNode("span",{class:"bar"});return r.appendChild(n),r.appendChild(o),r.appendChild(a),e.appendChild(r),{search_outer_wrapper:e,search_outer_input:n,search_outer:r,cross_icon:t,linkToSearchButton:o}},showSearchModal=function(){removeResults(),SEARCH_QUERY="",getInputField().blur(),document.querySelector(".search__outer__wrapper").classList.add("display-block");var e=document.querySelector(".search__outer__input");null!==e&&(e.value="",e.focus())},removeSearchModal=function(){removeResults();var e=document.querySelector(".search__outer__input");null!==e&&(e.value="",e.blur()),document.querySelector(".search__outer__wrapper").classList.remove("display-block")},getSearchUrl=function(e){return getProjectInfo().api_host+"/api/v2/docsearch/?"+convertObjToUrlParams(e)},getProjectInfo=function(){return{project:READTHEDOCS_DATA.project,version:READTHEDOCS_DATA.version,language:READTHEDOCS_DATA.language||"en",api_host:READTHEDOCS_DATA.api_host}},getUrlVars=function(){var n={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,r,t){n[r]=t});return n},copyToClipBoard=function(e){var r=createDomNode("textarea",{readonly:"",style:"position: absolute; left: -9999px;"});r.value=e,document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r)};window.addEventListener("DOMContentLoaded",function(e){if(void 0!==READTHEDOCS_DATA){var n=getProjectInfo(),r=generateAndReturnInitialHtml(),t=r.search_outer_wrapper,o=r.search_outer_input,a=r.cross_icon,c=r.linkToSearchButton;document.body.appendChild(t);var s=0,l=null,i=getInputField();i.addEventListener("focus",function(e){showSearchModal()}),o.addEventListener("input",function(e){SEARCH_QUERY=e.target.value;var r={q:encodeURIComponent(SEARCH_QUERY),project:n.project,version:n.version,language:n.language},t=getSearchUrl(r);"string"==typeof SEARCH_QUERY&&0<SEARCH_QUERY.length?(null!==l&&l.cancel(),(l=fetchAndGenerateResults(t,n.project))()):removeResults()}),o.addEventListener("keydown",function(e){if(40===e.keyCode&&(e.preventDefault(),TOTAL_RESULTS<(s+=1)&&(s=1),removeAllActive(),addActive(s)),38===e.keyCode&&(e.preventDefault(),(s-=1)<1&&(s=TOTAL_RESULTS),removeAllActive(),addActive(s)),13===e.keyCode){e.preventDefault();var r=document.querySelector(".search__result__single.active");if(null!==r){var t=r.firstChild.href;window.location.href=t}else{var n=document.querySelector("div[role='search'] form");i.value=SEARCH_QUERY||"",n.submit()}}}),t.addEventListener("click",function(e){e.target.parentNode===document.body&&removeSearchModal()}),a.addEventListener("click",function(e){removeSearchModal()}),c.addEventListener("click",function(e){e.preventDefault();var r=window.location.origin+window.location.pathname;null!=SEARCH_QUERY&&""!==SEARCH_QUERY&&(r+="?"+convertObjToUrlParams({rtd_search:encodeURIComponent(SEARCH_QUERY)}));copyToClipBoard(r)}),document.addEventListener("keydown",function(e){27===e.keyCode&&removeSearchModal()});var u=getUrlVars();if(void 0!==u.rtd_search&&"string"==typeof u.rtd_search&&""!==u.rtd_search){var d=decodeURIComponent(u.rtd_search),_=document.querySelector(".search__outer__input"),p=getProjectInfo(),v={q:encodeURIComponent(d),project:p.project,version:p.version,language:p.language},h=getSearchUrl(v);showSearchModal(),SEARCH_QUERY=d,_.value=SEARCH_QUERY,fetchAndGenerateResults(h,p.project)()}}});